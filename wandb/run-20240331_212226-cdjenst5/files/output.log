
Batch: 0, Loss: 8.178459167480469, Recon loss: 6.1784987449646, VQ loss: 0.9999799728393555, Commit loss: 0.9999799728393555
Batch: 1, Loss: 7.647713661193848, Recon loss: 5.647900581359863, VQ loss: 0.9999064207077026, Commit loss: 0.9999064207077026
Batch: 2, Loss: 7.217492580413818, Recon loss: 5.217671871185303, VQ loss: 0.9999101758003235, Commit loss: 0.9999101758003235
Batch: 3, Loss: 6.898261547088623, Recon loss: 4.898367404937744, VQ loss: 0.9999471306800842, Commit loss: 0.9999471306800842
Batch: 4, Loss: 6.7482380867004395, Recon loss: 4.748260974884033, VQ loss: 0.9999884963035583, Commit loss: 0.9999884963035583
Batch: 5, Loss: 6.570572853088379, Recon loss: 4.5705461502075195, VQ loss: 1.0000131130218506, Commit loss: 1.0000131130218506
Batch: 6, Loss: 6.40380334854126, Recon loss: 4.403740406036377, VQ loss: 1.000031590461731, Commit loss: 1.000031590461731
Batch: 7, Loss: 6.31052303314209, Recon loss: 4.310412406921387, VQ loss: 1.0000553131103516, Commit loss: 1.0000553131103516
Batch: 8, Loss: 6.1961188316345215, Recon loss: 4.195942401885986, VQ loss: 1.000088095664978, Commit loss: 1.000088095664978
Batch: 9, Loss: 6.133822441101074, Recon loss: 4.133594989776611, VQ loss: 1.0001137256622314, Commit loss: 1.0001137256622314
Batch: 10, Loss: 6.04044246673584, Recon loss: 4.0401506423950195, VQ loss: 1.0001457929611206, Commit loss: 1.0001457929611206
Batch: 11, Loss: 5.966257095336914, Recon loss: 3.9658899307250977, VQ loss: 1.0001834630966187, Commit loss: 1.0001834630966187
Batch: 12, Loss: 5.929023265838623, Recon loss: 3.9285635948181152, VQ loss: 1.0002297163009644, Commit loss: 1.0002297163009644
Batch: 13, Loss: 5.90179967880249, Recon loss: 3.901282548904419, VQ loss: 1.0002585649490356, Commit loss: 1.0002585649490356
Batch: 14, Loss: 5.804594993591309, Recon loss: 3.8039586544036865, VQ loss: 1.0003182888031006, Commit loss: 1.0003182888031006
Batch: 15, Loss: 5.824578285217285, Recon loss: 3.8238000869750977, VQ loss: 1.0003888607025146, Commit loss: 1.0003888607025146
Batch: 16, Loss: 5.762803554534912, Recon loss: 3.761868715286255, VQ loss: 1.0004674196243286, Commit loss: 1.0004674196243286
Batch: 17, Loss: 5.760465621948242, Recon loss: 3.7593960762023926, VQ loss: 1.0005347728729248, Commit loss: 1.0005347728729248
Batch: 18, Loss: 5.746882438659668, Recon loss: 3.7456343173980713, VQ loss: 1.0006240606307983, Commit loss: 1.0006240606307983
Batch: 19, Loss: 5.737570285797119, Recon loss: 3.7362072467803955, VQ loss: 1.0006815195083618, Commit loss: 1.0006815195083618
Batch: 20, Loss: 5.687718391418457, Recon loss: 3.6862175464630127, VQ loss: 1.0007505416870117, Commit loss: 1.0007505416870117
Batch: 21, Loss: 5.610749244689941, Recon loss: 3.6090915203094482, VQ loss: 1.000828742980957, Commit loss: 1.000828742980957
Batch: 22, Loss: 5.62965202331543, Recon loss: 3.627854347229004, VQ loss: 1.0008989572525024, Commit loss: 1.0008989572525024
Batch: 23, Loss: 5.618293762207031, Recon loss: 3.616342782974243, VQ loss: 1.0009753704071045, Commit loss: 1.0009753704071045
Batch: 24, Loss: 5.662973403930664, Recon loss: 3.660816192626953, VQ loss: 1.001078724861145, Commit loss: 1.001078724861145
Batch: 25, Loss: 5.602529048919678, Recon loss: 3.600222110748291, VQ loss: 1.001153588294983, Commit loss: 1.001153588294983
Batch: 26, Loss: 5.6355204582214355, Recon loss: 3.632986307144165, VQ loss: 1.0012669563293457, Commit loss: 1.0012669563293457
Batch: 27, Loss: 5.559308052062988, Recon loss: 3.556601047515869, VQ loss: 1.0013535022735596, Commit loss: 1.0013535022735596
Batch: 28, Loss: 5.58892822265625, Recon loss: 3.5859808921813965, VQ loss: 1.0014736652374268, Commit loss: 1.0014736652374268
Batch: 29, Loss: 5.558539390563965, Recon loss: 3.555426597595215, VQ loss: 1.001556158065796, Commit loss: 1.001556158065796
Batch: 30, Loss: 5.5870280265808105, Recon loss: 3.5836691856384277, VQ loss: 1.0016793012619019, Commit loss: 1.0016793012619019
Batch: 31, Loss: 5.550328254699707, Recon loss: 3.5466883182525635, VQ loss: 1.0018198490142822, Commit loss: 1.0018198490142822
Batch: 32, Loss: 5.524167537689209, Recon loss: 3.520355463027954, VQ loss: 1.0019060373306274, Commit loss: 1.0019060373306274
Batch: 33, Loss: 5.540288925170898, Recon loss: 3.536235809326172, VQ loss: 1.0020263195037842, Commit loss: 1.0020263195037842
Batch: 34, Loss: 5.527440071105957, Recon loss: 3.5231428146362305, VQ loss: 1.0021488666534424, Commit loss: 1.0021488666534424
Batch: 35, Loss: 5.524801254272461, Recon loss: 3.5202341079711914, VQ loss: 1.0022834539413452, Commit loss: 1.0022834539413452
Batch: 36, Loss: 5.468075275421143, Recon loss: 3.4632554054260254, VQ loss: 1.002409815788269, Commit loss: 1.002409815788269
Batch: 37, Loss: 5.459366798400879, Recon loss: 3.454204559326172, VQ loss: 1.0025811195373535, Commit loss: 1.0025811195373535
Batch: 38, Loss: 5.492436408996582, Recon loss: 3.4870424270629883, VQ loss: 1.002697229385376, Commit loss: 1.002697229385376
Batch: 39, Loss: 5.475164413452148, Recon loss: 3.469525098800659, VQ loss: 1.0028196573257446, Commit loss: 1.0028196573257446
Batch: 40, Loss: 5.494004726409912, Recon loss: 3.488124370574951, VQ loss: 1.0029401779174805, Commit loss: 1.0029401779174805
Batch: 41, Loss: 5.495678424835205, Recon loss: 3.4896929264068604, VQ loss: 1.0029927492141724, Commit loss: 1.0029927492141724
Batch: 42, Loss: 5.443784236907959, Recon loss: 3.437422513961792, VQ loss: 1.0031808614730835, Commit loss: 1.0031808614730835
Batch: 43, Loss: 5.424837589263916, Recon loss: 3.4182381629943848, VQ loss: 1.0032997131347656, Commit loss: 1.0032997131347656
Batch: 44, Loss: 5.409812927246094, Recon loss: 3.4030532836914062, VQ loss: 1.0033795833587646, Commit loss: 1.0033795833587646
Batch: 45, Loss: 5.438535690307617, Recon loss: 3.4315690994262695, VQ loss: 1.0034832954406738, Commit loss: 1.0034832954406738
Batch: 46, Loss: 5.421636581420898, Recon loss: 3.4144279956817627, VQ loss: 1.0036042928695679, Commit loss: 1.0036042928695679
Batch: 47, Loss: 5.418624401092529, Recon loss: 3.411181688308716, VQ loss: 1.0037213563919067, Commit loss: 1.0037213563919067
Batch: 48, Loss: 5.4127631187438965, Recon loss: 3.405137300491333, VQ loss: 1.0038129091262817, Commit loss: 1.0038129091262817
Batch: 49, Loss: 5.411767482757568, Recon loss: 3.4039015769958496, VQ loss: 1.0039328336715698, Commit loss: 1.0039328336715698
Batch: 50, Loss: 5.4056077003479, Recon loss: 3.3976023197174072, VQ loss: 1.0040026903152466, Commit loss: 1.0040026903152466
Batch: 51, Loss: 5.384584426879883, Recon loss: 3.3763937950134277, VQ loss: 1.0040953159332275, Commit loss: 1.0040953159332275
Batch: 52, Loss: 5.383735179901123, Recon loss: 3.3752684593200684, VQ loss: 1.004233479499817, Commit loss: 1.004233479499817
Batch: 53, Loss: 5.43043327331543, Recon loss: 3.4217236042022705, VQ loss: 1.0043548345565796, Commit loss: 1.0043548345565796
Batch: 54, Loss: 5.375838279724121, Recon loss: 3.366953134536743, VQ loss: 1.0044424533843994, Commit loss: 1.0044424533843994
Batch: 55, Loss: 5.451484680175781, Recon loss: 3.4424526691436768, VQ loss: 1.0045160055160522, Commit loss: 1.0045160055160522
Batch: 56, Loss: 5.371653079986572, Recon loss: 3.362459897994995, VQ loss: 1.0045965909957886, Commit loss: 1.0045965909957886
Batch: 57, Loss: 5.33106803894043, Recon loss: 3.3216769695281982, VQ loss: 1.0046956539154053, Commit loss: 1.0046956539154053
Batch: 58, Loss: 5.4420061111450195, Recon loss: 3.4322633743286133, VQ loss: 1.0048713684082031, Commit loss: 1.0048713684082031
Batch: 59, Loss: 5.336269378662109, Recon loss: 3.326348066329956, VQ loss: 1.0049606561660767, Commit loss: 1.0049606561660767
Batch: 60, Loss: 5.370753288269043, Recon loss: 3.360586643218994, VQ loss: 1.0050833225250244, Commit loss: 1.0050833225250244
Batch: 61, Loss: 5.394395351409912, Recon loss: 3.3840584754943848, VQ loss: 1.0051685571670532, Commit loss: 1.0051685571670532
Batch: 62, Loss: 5.337275505065918, Recon loss: 3.3265883922576904, VQ loss: 1.0053436756134033, Commit loss: 1.0053436756134033
Batch: 63, Loss: 5.334232330322266, Recon loss: 3.323488712310791, VQ loss: 1.0053718090057373, Commit loss: 1.0053718090057373
Batch: 64, Loss: 5.397191524505615, Recon loss: 3.386125087738037, VQ loss: 1.0055330991744995, Commit loss: 1.0055330991744995
Batch: 65, Loss: 5.34558629989624, Recon loss: 3.3342299461364746, VQ loss: 1.0056781768798828, Commit loss: 1.0056781768798828
Batch: 66, Loss: 5.440061569213867, Recon loss: 3.4284298419952393, VQ loss: 1.005815863609314, Commit loss: 1.005815863609314
Batch: 67, Loss: 5.2942328453063965, Recon loss: 3.2824015617370605, VQ loss: 1.0059157609939575, Commit loss: 1.0059157609939575
Batch: 68, Loss: 5.3567728996276855, Recon loss: 3.3447024822235107, VQ loss: 1.006035327911377, Commit loss: 1.006035327911377
Batch: 69, Loss: 5.342264652252197, Recon loss: 3.3300204277038574, VQ loss: 1.0061219930648804, Commit loss: 1.0061219930648804
Batch: 70, Loss: 5.3716349601745605, Recon loss: 3.3590798377990723, VQ loss: 1.0062775611877441, Commit loss: 1.0062775611877441
Batch: 71, Loss: 5.32845401763916, Recon loss: 3.3155739307403564, VQ loss: 1.0064400434494019, Commit loss: 1.0064400434494019
Batch: 72, Loss: 5.3076043128967285, Recon loss: 3.294654130935669, VQ loss: 1.0064749717712402, Commit loss: 1.0064749717712402
Batch: 73, Loss: 5.3324055671691895, Recon loss: 3.3191189765930176, VQ loss: 1.006643295288086, Commit loss: 1.006643295288086
Batch: 74, Loss: 5.295446395874023, Recon loss: 3.281975030899048, VQ loss: 1.0067356824874878, Commit loss: 1.0067356824874878
Batch: 75, Loss: 5.3568830490112305, Recon loss: 3.34311580657959, VQ loss: 1.0068838596343994, Commit loss: 1.0068838596343994
Batch: 76, Loss: 5.323360443115234, Recon loss: 3.3093528747558594, VQ loss: 1.0070037841796875, Commit loss: 1.0070037841796875
Batch: 77, Loss: 5.336625576019287, Recon loss: 3.3222601413726807, VQ loss: 1.0071825981140137, Commit loss: 1.0071825981140137
Batch: 78, Loss: 5.29652214050293, Recon loss: 3.2817299365997314, VQ loss: 1.0073961019515991, Commit loss: 1.0073961019515991
Batch: 79, Loss: 5.271596908569336, Recon loss: 3.25653076171875, VQ loss: 1.007533311843872, Commit loss: 1.007533311843872
Batch: 80, Loss: 5.3089189529418945, Recon loss: 3.2938363552093506, VQ loss: 1.007541298866272, Commit loss: 1.007541298866272
Batch: 81, Loss: 5.274120330810547, Recon loss: 3.2586002349853516, VQ loss: 1.0077600479125977, Commit loss: 1.0077600479125977
Batch: 82, Loss: 5.302677631378174, Recon loss: 3.286893367767334, VQ loss: 1.00789213180542, Commit loss: 1.00789213180542
Batch: 83, Loss: 5.239840030670166, Recon loss: 3.223623752593994, VQ loss: 1.008108139038086, Commit loss: 1.008108139038086
Batch: 84, Loss: 5.292509078979492, Recon loss: 3.275980234146118, VQ loss: 1.0082645416259766, Commit loss: 1.0082645416259766
Batch: 85, Loss: 5.296891212463379, Recon loss: 3.279961585998535, VQ loss: 1.0084648132324219, Commit loss: 1.0084648132324219
Batch: 86, Loss: 5.232856273651123, Recon loss: 3.215334415435791, VQ loss: 1.008760929107666, Commit loss: 1.008760929107666
Batch: 87, Loss: 5.2576904296875, Recon loss: 3.239936590194702, VQ loss: 1.0088768005371094, Commit loss: 1.0088768005371094
Batch: 88, Loss: 5.253690719604492, Recon loss: 3.235771417617798, VQ loss: 1.0089595317840576, Commit loss: 1.0089595317840576
Batch: 89, Loss: 5.218512058258057, Recon loss: 3.200035572052002, VQ loss: 1.009238362312317, Commit loss: 1.009238362312317
Batch: 90, Loss: 5.26784086227417, Recon loss: 3.248871326446533, VQ loss: 1.0094847679138184, Commit loss: 1.0094847679138184
Batch: 91, Loss: 5.2592010498046875, Recon loss: 3.239959955215454, VQ loss: 1.0096204280853271, Commit loss: 1.0096204280853271
Batch: 92, Loss: 5.242531776428223, Recon loss: 3.2228822708129883, VQ loss: 1.0098246335983276, Commit loss: 1.0098246335983276
Batch: 93, Loss: 5.241950988769531, Recon loss: 3.2218856811523438, VQ loss: 1.0100326538085938, Commit loss: 1.0100326538085938
Batch: 94, Loss: 5.19163703918457, Recon loss: 3.17122483253479, VQ loss: 1.0102061033248901, Commit loss: 1.0102061033248901
Batch: 95, Loss: 5.205655574798584, Recon loss: 3.184882640838623, VQ loss: 1.010386347770691, Commit loss: 1.010386347770691
Batch: 96, Loss: 5.241235733032227, Recon loss: 3.2200558185577393, VQ loss: 1.0105899572372437, Commit loss: 1.0105899572372437
Batch: 97, Loss: 5.226848125457764, Recon loss: 3.205348491668701, VQ loss: 1.0107496976852417, Commit loss: 1.0107496976852417
Batch: 98, Loss: 5.247586250305176, Recon loss: 3.2257025241851807, VQ loss: 1.010941743850708, Commit loss: 1.010941743850708
Batch: 99, Loss: 5.215994834899902, Recon loss: 3.193965196609497, VQ loss: 1.0110149383544922, Commit loss: 1.0110149383544922
Batch: 100, Loss: 5.2302703857421875, Recon loss: 3.207998752593994, VQ loss: 1.0111358165740967, Commit loss: 1.0111358165740967
Batch: 101, Loss: 5.246274948120117, Recon loss: 3.223252296447754, VQ loss: 1.0115113258361816, Commit loss: 1.0115113258361816
Batch: 102, Loss: 5.214291095733643, Recon loss: 3.190946340560913, VQ loss: 1.0116724967956543, Commit loss: 1.0116724967956543
Batch: 103, Loss: 5.219817161560059, Recon loss: 3.1960668563842773, VQ loss: 1.011875033378601, Commit loss: 1.011875033378601
Batch: 104, Loss: 5.174731731414795, Recon loss: 3.1504948139190674, VQ loss: 1.0121184587478638, Commit loss: 1.0121184587478638
Batch: 105, Loss: 5.194023132324219, Recon loss: 3.1695172786712646, VQ loss: 1.0122530460357666, Commit loss: 1.0122530460357666
Batch: 106, Loss: 5.233298301696777, Recon loss: 3.2084743976593018, VQ loss: 1.0124119520187378, Commit loss: 1.0124119520187378
Batch: 107, Loss: 5.1421403884887695, Recon loss: 3.1169040203094482, VQ loss: 1.0126181840896606, Commit loss: 1.0126181840896606
Batch: 108, Loss: 5.1958160400390625, Recon loss: 3.1699581146240234, VQ loss: 1.0129287242889404, Commit loss: 1.0129287242889404
Batch: 109, Loss: 5.19788932800293, Recon loss: 3.171649694442749, VQ loss: 1.0131196975708008, Commit loss: 1.0131196975708008
Batch: 110, Loss: 5.176362037658691, Recon loss: 3.14980411529541, VQ loss: 1.0132789611816406, Commit loss: 1.0132789611816406
Batch: 111, Loss: 5.16124153137207, Recon loss: 3.134408950805664, VQ loss: 1.013416051864624, Commit loss: 1.013416051864624
Batch: 112, Loss: 5.18563985824585, Recon loss: 3.1582090854644775, VQ loss: 1.0137152671813965, Commit loss: 1.0137152671813965
Batch: 113, Loss: 5.168628692626953, Recon loss: 3.140575408935547, VQ loss: 1.014026403427124, Commit loss: 1.014026403427124
Batch: 114, Loss: 5.198696136474609, Recon loss: 3.170337677001953, VQ loss: 1.014178991317749, Commit loss: 1.014178991317749
Batch: 115, Loss: 5.1743645668029785, Recon loss: 3.145470142364502, VQ loss: 1.0144472122192383, Commit loss: 1.0144472122192383
Batch: 116, Loss: 5.173746109008789, Recon loss: 3.144141674041748, VQ loss: 1.0148022174835205, Commit loss: 1.0148022174835205
Batch: 117, Loss: 5.166759490966797, Recon loss: 3.1364593505859375, VQ loss: 1.0151500701904297, Commit loss: 1.0151500701904297
Batch: 118, Loss: 5.178367614746094, Recon loss: 3.1475565433502197, VQ loss: 1.015405535697937, Commit loss: 1.015405535697937
Batch: 119, Loss: 5.192323207855225, Recon loss: 3.1611580848693848, VQ loss: 1.0155824422836304, Commit loss: 1.0155824422836304
Batch: 120, Loss: 5.16864538192749, Recon loss: 3.1371219158172607, VQ loss: 1.0157617330551147, Commit loss: 1.0157617330551147
Batch: 121, Loss: 5.162942886352539, Recon loss: 3.1309974193573, VQ loss: 1.0159728527069092, Commit loss: 1.0159728527069092
Batch: 122, Loss: 5.171375751495361, Recon loss: 3.13909649848938, VQ loss: 1.0161395072937012, Commit loss: 1.0161395072937012
Batch: 123, Loss: 5.134339332580566, Recon loss: 3.101803779602051, VQ loss: 1.0162677764892578, Commit loss: 1.0162677764892578
Batch: 124, Loss: 5.1849260330200195, Recon loss: 3.1517858505249023, VQ loss: 1.0165703296661377, Commit loss: 1.0165703296661377
Batch: 125, Loss: 5.14021635055542, Recon loss: 3.106752634048462, VQ loss: 1.0167317390441895, Commit loss: 1.0167317390441895
Batch: 126, Loss: 5.136928558349609, Recon loss: 3.1028192043304443, VQ loss: 1.0170546770095825, Commit loss: 1.0170546770095825
Batch: 127, Loss: 5.151811599731445, Recon loss: 3.1174142360687256, VQ loss: 1.0171985626220703, Commit loss: 1.0171985626220703
Batch: 128, Loss: 5.129416465759277, Recon loss: 3.094815492630005, VQ loss: 1.0173003673553467, Commit loss: 1.0173003673553467
Batch: 129, Loss: 5.116692543029785, Recon loss: 3.0814578533172607, VQ loss: 1.0176174640655518, Commit loss: 1.0176174640655518
Batch: 130, Loss: 5.139594554901123, Recon loss: 3.1040165424346924, VQ loss: 1.0177890062332153, Commit loss: 1.0177890062332153
Batch: 131, Loss: 5.134778022766113, Recon loss: 3.09879994392395, VQ loss: 1.017989158630371, Commit loss: 1.017989158630371
Batch: 132, Loss: 5.100166320800781, Recon loss: 3.0635409355163574, VQ loss: 1.018312692642212, Commit loss: 1.018312692642212
Batch: 133, Loss: 5.12391996383667, Recon loss: 3.087017297744751, VQ loss: 1.01845121383667, Commit loss: 1.01845121383667
Traceback (most recent call last):
  File "/Users/austinstone/bittersweet/train.py", line 205, in <module>
    criterion=criterion, compression_ratio=config['compression_ratio'])
  File "/Users/austinstone/bittersweet/train.py", line 197, in main
    steps = 0
  File "/Users/austinstone/bittersweet/train.py", line 113, in train
    loss.backward()
  File "/Users/austinstone/Library/Python/3.9/lib/python/site-packages/torch/_tensor.py", line 522, in backward
    torch.autograd.backward(
  File "/Users/austinstone/Library/Python/3.9/lib/python/site-packages/torch/autograd/__init__.py", line 266, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt